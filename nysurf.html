<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì„œí•‘ ë³´ë“œ ìë™ ë§¤ì¹­ íˆ´ - í™•ì¥íŒ</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body { font-family: Arial, sans-serif; background:#f0f4f8; margin:0; padding:20px; }
    h1 { text-align:center; }
    .container { max-width:800px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
    label { display:block; margin-top:10px; font-weight:bold; }
    select, input { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
    button { margin-top:15px; padding:10px; width:100%; background:#0077cc; color:white; border:none; border-radius:5px; font-size:16px; cursor:pointer; }
    button:hover { background:#005fa3; }
    .result { margin-top:20px; background:#eef; padding:15px; border-radius:5px; }
    .board-card { display:flex; align-items:center; background:white; margin-top:10px; padding:10px; border-radius:5px; border:1px solid #ddd; }
    .board-card img { width:120px; height:auto; border-radius:5px; margin-right:15px; }
    .board-card h3 { margin:0; }
    .pin { font-style:italic; color:#555; font-size:14px; }
    canvas { margin-top:20px; background:white; padding:10px; border-radius:5px; }
</style>
</head>
<body>
<h1>ğŸ„ â™‚ï¸ ì‹¤ì‹œê°„ ì„œí•‘ ë³´ë“œ ìë™ ë§¤ì¹­</h1>
<div class="container">
    <label>ì„œí•‘ ìŠ¤íŒŸ</label>
    <select id="spot">
        <option value="namyeol">ë‚¨ì—´</option>
        <option value="yangyang">ì–‘ì–‘</option>
        <option value="busan">ë¶€ì‚° ì†¡ì •</option>
    </select>

    <button onclick="getSurfData()">ì‹¤ì‹œê°„ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</button>

    <div id="liveData" style="margin-top:15px; display:none;"></div>
    <canvas id="waveChart" style="display:none;"></canvas>
    <div id="result" class="result" style="display:none;"></div>
</div>

<script>
// ë³´ë“œ ë°ì´í„°
const boards = [
    { name: "Sharp Eye Synergy", size: "6'0\" 30.5L", tail: "Round Tail", fin: "Thruster", img:"https://example.com/synergy.jpg", desc: "ì¤‘~í° íŒŒë„ í¼í¬ë¨¼ìŠ¤ ìˆë³´ë“œ, íŒŒì›Œ ìˆëŠ” í´ë¦° í˜ì´ìŠ¤ì— ê°•í•¨" },
    { name: "Lost Sub Driver 3.0", size: "5'10\" 31.0L", tail: "Squash Tail", fin: "Thruster/Quad", img:"https://example.com/subdriver.jpg", desc: "ì•½~ì¤‘ê°„ íŒŒë„ í•˜ì´ë¸Œë¦¬ë“œ í¼í¬ë¨¼ìŠ¤, íŒ¨ë“¤ë ¥Â·ê°€ì† ìš°ìˆ˜" },
    { name: "Chilli Fade 2.0", size: "5'11\" 30.8L", tail: "Squash Tail", fin: "Thruster", img:"https://example.com/fade.jpg", desc: "ì˜¬ë¼ìš´ë“œ í¼í¬ë¨¼ìŠ¤ ìˆë³´ë“œ, ë‹¤ì–‘í•œ ì¡°ê±´ ëŒ€ì‘ ê°€ëŠ¥" },
    { name: "JS Monsta", size: "6'0\" 30.5L", tail: "Round Tail", fin: "Thruster", img:"https://example.com/monsta.jpg", desc: "ì˜¬ë¼ìš´ë“œ í¼í¬ë¨¼ìŠ¤, ì¤‘~í° íŒŒë„ ì•ˆì •ì„±Â·ë“œë¼ì´ë¸Œ ìš°ìˆ˜" },
    { name: "Channel Islands Bobby Quad", size: "5'8\" 29.0L", tail: "Swallow Tail", fin: "Quad", img:"https://example.com/bobbyquad.jpg", desc: "í¼í¬ë¨¼ìŠ¤ í”¼ì‹œ, ì‘ì€~ì¤‘ê°„ íŒŒë„ ì†ë„Â·ìœ ì—°ì„± ê°•ì " }
];

// ìŠ¤íŒŸ ì¢Œí‘œ
const spots = {
    namyeol: { lat: 34.605, lon: 127.287 },
    yangyang: { lat: 38.073, lon: 128.626 },
    busan: { lat: 35.179, lon: 129.199 }
};

// í’í–¥ ë³€í™˜
function degToDirection(deg) {
    const dirs = ['ë¶', 'ë¶ë™', 'ë™', 'ë‚¨ë™', 'ë‚¨', 'ë‚¨ì„œ', 'ì„œ', 'ë¶ì„œ'];
    return dirs[Math.round(deg / 45) % 8];
}

// ì‹¤ì‹œê°„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
async function getSurfData() {
    const spot = document.getElementById('spot').value;
    const { lat, lon } = spots[spot];
    const url = `https://marine-api.open-meteo.com/v1/marine?latitude=${lat}&longitude=${lon}&hourly=wave_height,wave_period,wind_speed,wind_direction&timezone=auto`;
    const res = await fetch(url);
    const data = await res.json();

    // í˜„ì¬ ì‹œê°„ ë°ì´í„°
    const h = data.hourly.wave_height[0];
    const p = data.hourly.wave_period[0];
    const ws = data.hourly.wind_speed[0];
    const wd = degToDirection(data.hourly.wind_direction[0]);

    document.getElementById('liveData').style.display = "block";
    document.getElementById('liveData').innerHTML = `
        <h3>ğŸŒŠ ì‹¤ì‹œê°„ ì¡°ê±´</h3>
        <p>íŒŒê³ : ${h.toFixed(1)} m</p>
        <p>í”¼ë¦¬ì–´ë“œ: ${p.toFixed(1)} s</p>
        <p>ë°”ëŒ: ${wd} ${ws.toFixed(1)} m/s</p>
    `;

    drawWaveChart(data);
    matchBoard(h, p, wd, ws);
}

// íŒŒë„ ê·¸ë˜í”„
function drawWaveChart(data) {
    const ctx = document.getElementById('waveChart').getContext('2d');
    document.getElementById('waveChart').style.display = "block";
    const labels = data.hourly.time.slice(0, 24).map(t => t.slice(11, 16));
    const waveData = data.hourly.wave_height.slice(0, 24);
    const periodData = data.hourly.wave_period.slice(0, 24);

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                { label: 'íŒŒê³ (m)', data: waveData, borderColor: 'blue', fill:false, yAxisID: 'y1' },
                { label: 'í”¼ë¦¬ì–´ë“œ(s)', data: periodData, borderColor: 'green', fill:false, yAxisID: 'y2' }
            ]
        },
        options: {
            responsive:true,
            scales: {
                y1: { type: 'linear', position: 'left' },
                y2: { type: 'linear', position: 'right' }
            }
        }
    });
}

// ë§¤ì¹­ ë¡œì§
function matchBoard(h, p, wd, ws) {
    let picks = [];
    let reason = "";

    if (h <= 1.0 && p <= 8) {
        picks = [boards[4], boards[1], boards[2]];
        reason = "ì‘ì€~ì¤‘ê°„ íŒŒë„, ì§§ì€ ì£¼ê¸°ë¼ ë¹ ë¥¸ ê°€ì†Â·ìœ ì§€ë ¥ ì¢‹ì€ ë³´ë“œ ì¶”ì²œ";
    } else if (h > 1.0 && h <= 1.3 && p >= 8) {
        picks = [boards[0], boards[3], boards[2]];
        reason = "ì¤‘ê°„ ì‚¬ì´ì¦ˆ, ì£¼ê¸° ê¸¸ì–´ í¼í¬ë¨¼ìŠ¤ ë³´ë“œê°€ ì í•©";
    } else if (h >= 1.3 && p >= 9) {
        picks = [boards[0], boards[3]];
        reason = "í° íŒŒë„ì™€ ê¸´ ì£¼ê¸°ì— ë§ì¶° ì•ˆì •ì  ë“œë¼ì´ë¸Œ ê°€ëŠ¥í•œ ë³´ë“œ ì„ íƒ";
    } else if (h <= 0.9 && p <= 7 && ws > 5) {
        picks = [boards[4], boards[1]];
        reason = "ì‘ì€ íŒŒë„ + ê°•í•œ ë°”ëŒ, ë¹ ë¥´ê²Œ ëœ¨ëŠ” ë³´ë“œ í•„ìš”";
    } else {
        picks = [boards[2], boards[1], boards[4]];
        reason = "ì˜¬ë¼ìš´ë“œ ì¡°ê±´, ë°¸ëŸ°ìŠ¤ ì¢‹ì€ ë³´ë“œ ì„ íƒ";
    }

    let html = `<h2>ì¶”ì²œ ë³´ë“œ</h2><p>${reason}</p>`;
    picks.forEach((b, i) => {
        html += `<div class="board-card">
            <img src="${b.img}" alt="${b.name}">
            <div>
                <h3>${i+1}ìˆœìœ„: ${b.name}</h3>
                <p>${b.size} / ${b.tail} / ${b.fin}</p>
                <p>${b.desc}</p>
                <p class="pin">í•€ ì¶”ì²œ: ${b.fin.includes("Quad") ? "ì¿¼ë“œ Performer" : "Thruster Performer"}</p>
            </div>
        </div>`;
    });

    document.getElementById('result').innerHTML = html;
    document.getElementById('result').style.display = "block";
}
</script>
</body>
</html>